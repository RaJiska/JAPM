cmake_minimum_required (VERSION 2.6)
project (JAPM)

set (JAPM_NAME "JAPM (Just Another PBO Manager)")
set (JAPM_VERSION_MAJOR 0)
set (JAPM_VERSION_MINOR 2)
set (JAPM_PATH_MAX_LENGTH 1024)
set (INCLUDE_DIR "${PROJECT_SOURCE_DIR}/include")
set (SOURCE_DIR "${PROJECT_SOURCE_DIR}/src")
set (LIB_DIR "${PROJECT_SOURCE_DIR}/lib")
set (SRCS
	"${SOURCE_DIR}/main.c"
	"${SOURCE_DIR}/japm.c"
	"${SOURCE_DIR}/fs/fs_path_is_valid.c"
	"${SOURCE_DIR}/fs/fs_path_clean.c"
	"${SOURCE_DIR}/pbo/pbo_open.c"
	"${SOURCE_DIR}/pbo/pbo_get_header_block.c"
	"${SOURCE_DIR}/pbo/pbo_get_data_block.c"
	"${SOURCE_DIR}/pbo/pbo_get_checksum_block.c"
	"${SOURCE_DIR}/pbo/pbo_retrieve_entries.c"
	"${SOURCE_DIR}/pbo/pbo_extract.c"
	"${SOURCE_DIR}/pbo/pbo_close.c"
)


configure_file(
	"${INCLUDE_DIR}/japm_conf.h.in"
	"${INCLUDE_DIR}/japm_conf.h"
)

include_directories("${INCLUDE_DIR}")
include_directories("${LIB_DIR}/list/include")
include_directories("${LIB_DIR}/utils/include")

file(GLOB LIBLIST_SRC "${LIB_DIR}/list/src/*.c")
add_library(LIBLIST STATIC ${LIBLIST_SRC})
target_include_directories(LIBLIST PUBLIC "${LIB_DIR}/list/include")
file(GLOB LIBUTILS_SRC "${LIB_DIR}/utils/src/*.c")
add_library(LIBUTILS STATIC ${LIBUTILS_SRC})
target_include_directories(LIBUTILS PUBLIC "${LIB_DIR}/utils/include")

add_executable(JAPM ${SRCS})
target_link_libraries(JAPM LIBLIST)
target_link_libraries(JAPM LIBUTILS)